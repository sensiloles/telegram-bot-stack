# ğŸ¤– Cursor Agent Quick Reference

## ğŸ“ START HERE - Agent Orientation

### On Every New Context:
1. **Read:** `.github/PROJECT_STATUS.md` (current phase, open issues)
2. **Check:** `python3 .github/workflows/scripts/read_issues.py --list --state open`
3. **Understand:** Read relevant section of `PACKAGE_CONVERSION_PLAN_RU.md`
4. **Act:** Follow issue checklist or user request

### When User Says "Continue Work":
```bash
# Auto-workflow:
1. Check PROJECT_STATUS.md â†’ current phase
2. List open issues â†’ identify active issue
3. Read issue details â†’ understand task
4. Check plan context â†’ understand why
5. Implement â†’ follow issue acceptance criteria
```

## ğŸ¯ Project Context (Quick Facts)

**Project:** telegram-bot-stack (reusable Telegram bot framework)
**Current Phase:** Phase 0.3 - Validation & Documentation
**Repository:** https://github.com/sensiloles/telegram-bot-stack
**Master Plan:** `PACKAGE_CONVERSION_PLAN_RU.md` (lines 761-1928)

**Progress:**
- âœ… Phase 0.1: Extract framework â†’ src/core/
- âœ… Phase 0.2: Tests (111 tests, 81% coverage)
- ğŸ”„ Phase 0.3: Validation & docs (current)
- â³ Phase 1: PyPI package release (next)

## ğŸ“š Quick Navigation

| Need | File | Lines |
|------|------|-------|
| Project status | `.github/PROJECT_STATUS.md` | All |
| Create issues | `.github/HOW_TO_CREATE_ISSUES.md` | All |
| Current phase plan | `PACKAGE_CONVERSION_PLAN_RU.md` | 804-847 |
| Architecture | `README.md` | 155-250 |
| Testing guide | `README.md` | 80-154 |
| Git workflow | This file | 50-80 |

## ğŸ”„ Essential Workflows

### Git Commits (Conventional Commits)
```bash
# Always:
1. git status && git diff --stat
2. git log --oneline -10                     # Check style
3. Update docs BEFORE commit
4. git add .
5. git commit -m "type(scope): description"
6. Format: feat/fix/docs/refactor/test/chore
```

**Examples:**
- `feat(core): add new storage backend`
- `fix(tests): resolve coverage calculation`
- `docs(readme): update architecture section`
- `test(storage): add edge case tests`

### GitHub Issues (Use PyGithub)
```python
# ALWAYS use PyGithub (NOT gh CLI)
from github import Github
g = Github(os.getenv("GITHUB_TOKEN"))
repo = g.get_repo("sensiloles/telegram-bot-stack")
issue = repo.create_issue(
title="[Type] Phase X.X: Description",
body=content,
labels=["label1", "label2"]
)
```

**See:** `.github/HOW_TO_CREATE_ISSUES.md` for full template.

### Testing
```bash
# Run tests
python3 -m pytest

# With coverage (threshold: 80%)
python3 -m pytest --cov=src/core --cov-report=term

# CI/CD: .github/workflows/tests.yml
```

## âš¡ Critical Rules

### Security
- **NEVER** commit tokens/passwords
- Use `.env` (must be in `.gitignore`)
- Validate tokens at startup

### Code Quality
- All comments/docstrings in **English**
- Use type hints for all new code
- Follow `ruff` linting rules
- Remove unused imports/code immediately

### Documentation
- Update docs **BEFORE** committing code
- Keep examples executable
- Verify instructions work "out of the box"

### Testing
- Maintain â‰¥80% coverage for `src/core/`
- Write tests for all new features
- Use fixtures from `tests/conftest.py`

## ğŸ—‚ï¸ Project Structure

```
src/
â”œâ”€â”€ core/                # Reusable framework (test coverage 81%)
â”‚ â”œâ”€â”€ bot_base.py      # Base class with hooks
â”‚ â”œâ”€â”€ storage.py       # JSON storage abstraction
â”‚ â”œâ”€â”€ user_manager.py
â”‚ â””â”€â”€ admin_manager.py
â”œâ”€â”€ quit_smoking/        # Bot-specific logic
â”‚ â”œâ”€â”€ bot.py           # Inherits BotBase
â”‚ â””â”€â”€ ...
tests/
â”œâ”€â”€ core/                # Unit tests (100% for storage/managers)
â””â”€â”€ integration/         # E2E tests
```

## ğŸ’¡ Tips for Token Efficiency

**DON'T read entire files unnecessarily:**
- Use `codebase_search` for understanding
- Use `grep` for finding specific code
- Read specific line ranges: `read_file` with offset/limit

**DO read these on start:**
- `.github/PROJECT_STATUS.md` (compact status)
- Current issue via script (structured output)
- Relevant plan section only (not entire file)

**Prioritize:**
1. Status file (20 lines) â†’ context
2. Issue details (50-100 lines) â†’ task
3. Plan section (50-100 lines) â†’ why
4. Code only when needed â†’ implementation

## ğŸ“‹ Detailed Rules (Reference)

**For complete rules, see archived version:**
- Git workflow details â†’ internal knowledge
- Cleanup procedures â†’ internal knowledge
- Documentation validation â†’ internal knowledge
- Code standards â†’ internal knowledge

**When needed, reference:**
- Conventional Commits: https://www.conventionalcommits.org/
- Pre-commit config: `.pre-commit-config.yaml`
- Test config: `pyproject.toml` [tool.pytest.ini_options]

---

**Remember:** Read `.github/PROJECT_STATUS.md` first on every new context! ğŸ¯
