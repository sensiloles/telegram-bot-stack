{
  "metadata": {
    "version": "2.0.0",
    "generated_at": "2025-11-19",
    "graph_id": "bot_framework",
    "graph_name": "Bot Framework Core",
    "graph_type": "specialized",
    "project_name": "telegram-bot-stack",
    "project_version": "1.5.0",
    "description": "Dependency graph for telegram bot framework core (telegram_bot_stack/)",
    "scope": "Bot framework implementation only",
    "root_package": "telegram_bot_stack",
    "node_count": 10,
    "edge_count": 17,
    "router_file": "graph-router.json",
    "related_graphs": [
      "testing-graph.json - for tests of these modules",
      "examples-graph.json - for usage examples",
      "project-meta-graph.json - for overall architecture"
    ]
  },
  "statistics": {
    "total_modules": 10,
    "total_classes": 7,
    "total_lines_of_code": 1513,
    "average_dependencies_per_module": 1.444,
    "max_dependencies": 4,
    "circular_dependencies": 0,
    "core_modules": [
      "storage.base",
      "bot_base",
      "__init__"
    ],
    "leaf_modules": [
      "storage.json",
      "storage.memory",
      "storage.sql"
    ]
  },
  "nodes": [
    {
      "id": "telegram_bot_stack.__init__",
      "name": "__init__",
      "type": "module",
      "category": "public_api",
      "path": "telegram_bot_stack/__init__.py",
      "description": "Main package entry point - exports public API for the framework",
      "lines_of_code": 57,
      "complexity_score": 1,
      "exports": [
        "BotBase",
        "UserManager",
        "AdminManager",
        "rate_limit",
        "StorageBackend",
        "JSONStorage",
        "MemoryStorage",
        "Storage",
        "create_storage",
        "__version__"
      ],
      "imports": {
        "internal": [
          "admin_manager.AdminManager",
          "bot_base.BotBase",
          "decorators.rate_limit",
          "storage.JSONStorage",
          "storage.MemoryStorage",
          "storage.Storage",
          "storage.StorageBackend",
          "storage.create_storage",
          "user_manager.UserManager"
        ],
        "external": []
      },
      "dependencies": [
        "telegram_bot_stack.admin_manager",
        "telegram_bot_stack.bot_base",
        "telegram_bot_stack.user_manager",
        "telegram_bot_stack.storage"
      ],
      "dependents": [],
      "tags": [
        "entry-point",
        "public-api",
        "aggregator"
      ],
      "role": "Aggregates and exposes framework's public API",
      "criticality": "high"
    },
    {
      "id": "telegram_bot_stack.bot_base",
      "name": "bot_base",
      "type": "module",
      "category": "core",
      "path": "telegram_bot_stack/bot_base.py",
      "description": "Base bot class with common patterns and hooks for customization",
      "lines_of_code": 562,
      "complexity_score": 8,
      "exports": [
        "BotBase"
      ],
      "imports": {
        "internal": [
          "admin_manager.AdminManager",
          "storage.StorageBackend",
          "user_manager.UserManager"
        ],
        "external": [
          "asyncio",
          "logging",
          "telegram",
          "telegram.ext",
          "typing.Optional"
        ]
      },
      "dependencies": [
        "telegram_bot_stack.admin_manager",
        "telegram_bot_stack.user_manager",
        "telegram_bot_stack.storage.base"
      ],
      "dependents": [
        "telegram_bot_stack.__init__"
      ],
      "classes": [
        {
          "name": "BotBase",
          "description": "Base class for telegram bots with common functionality",
          "public_methods": [
            "on_user_registered",
            "get_user_status",
            "get_welcome_message",
            "start",
            "my_id",
            "list_users",
            "list_admins",
            "add_admin",
            "remove_admin",
            "decline_admin",
            "handle_callback_query",
            "update_commands_for_user",
            "register_handlers",
            "set_bot_commands",
            "shutdown"
          ],
          "hooks": [
            "on_user_registered",
            "get_user_status",
            "get_welcome_message",
            "register_handlers"
          ],
          "composition": [
            "UserManager",
            "AdminManager",
            "StorageBackend",
            "Application"
          ]
        }
      ],
      "tags": [
        "core",
        "base-class",
        "extensible",
        "command-handlers"
      ],
      "role": "Core bot implementation with user/admin management and command handling",
      "criticality": "critical"
    },
    {
      "id": "telegram_bot_stack.user_manager",
      "name": "user_manager",
      "type": "module",
      "category": "core",
      "path": "telegram_bot_stack/user_manager.py",
      "description": "Generic user management for telegram bots",
      "lines_of_code": 113,
      "complexity_score": 3,
      "exports": [
        "UserManager"
      ],
      "imports": {
        "internal": [
          "storage.StorageBackend"
        ],
        "external": [
          "logging",
          "typing.List"
        ]
      },
      "dependencies": [
        "telegram_bot_stack.storage.base"
      ],
      "dependents": [
        "telegram_bot_stack.bot_base",
        "telegram_bot_stack.__init__"
      ],
      "classes": [
        {
          "name": "UserManager",
          "description": "Manages user registration and tracking",
          "public_methods": [
            "add_user",
            "remove_user",
            "user_exists",
            "get_all_users",
            "get_user_count",
            "save_users"
          ],
          "storage_keys": [
            "bot_users"
          ]
        }
      ],
      "tags": [
        "core",
        "user-management",
        "persistence"
      ],
      "role": "User registration and tracking with persistent storage",
      "criticality": "high"
    },
    {
      "id": "telegram_bot_stack.admin_manager",
      "name": "admin_manager",
      "type": "module",
      "category": "core",
      "path": "telegram_bot_stack/admin_manager.py",
      "description": "Generic admin management for telegram bots",
      "lines_of_code": 132,
      "complexity_score": 4,
      "exports": [
        "AdminManager"
      ],
      "imports": {
        "internal": [
          "storage.StorageBackend"
        ],
        "external": [
          "logging",
          "typing.List"
        ]
      },
      "dependencies": [
        "telegram_bot_stack.storage.base"
      ],
      "dependents": [
        "telegram_bot_stack.bot_base",
        "telegram_bot_stack.__init__"
      ],
      "classes": [
        {
          "name": "AdminManager",
          "description": "Manages administrator privileges for bot users",
          "public_methods": [
            "add_admin",
            "remove_admin",
            "is_admin",
            "get_all_admins",
            "get_admin_count",
            "has_admins",
            "save_admins"
          ],
          "storage_keys": [
            "bot_admins"
          ],
          "special_features": [
            "Prevents removing last admin",
            "Auto-creates first admin"
          ]
        }
      ],
      "tags": [
        "core",
        "admin-management",
        "persistence",
        "security"
      ],
      "role": "Admin privilege management with protection against lockout",
      "criticality": "high"
    },
    {
      "id": "telegram_bot_stack.storage",
      "name": "storage",
      "type": "module",
      "category": "core",
      "path": "telegram_bot_stack/storage/__init__.py",
      "description": "Storage abstraction layer with factory function",
      "lines_of_code": 78,
      "complexity_score": 2,
      "exports": [
        "StorageBackend",
        "JSONStorage",
        "MemoryStorage",
        "SQLStorage",
        "create_storage",
        "Storage"
      ],
      "imports": {
        "internal": [
          "storage.base.StorageBackend",
          "storage.json.JSONStorage",
          "storage.memory.MemoryStorage",
          "storage.sql.SQLStorage"
        ],
        "external": [
          "logging",
          "typing.Any",
          "typing.Optional"
        ]
      },
      "dependencies": [
        "telegram_bot_stack.storage.base",
        "telegram_bot_stack.storage.json",
        "telegram_bot_stack.storage.memory",
        "telegram_bot_stack.storage.sql"
      ],
      "dependents": [
        "telegram_bot_stack.__init__"
      ],
      "functions": [
        {
          "name": "create_storage",
          "description": "Factory function to create storage backends",
          "parameters": [
            "backend: str",
            "**kwargs: Any"
          ],
          "returns": "StorageBackend",
          "supported_backends": [
            "json",
            "memory",
            "sqlite",
            "postgres",
            "sql"
          ]
        }
      ],
      "tags": [
        "core",
        "abstraction-layer",
        "factory",
        "storage"
      ],
      "role": "Unified interface for different storage backends",
      "criticality": "critical"
    },
    {
      "id": "telegram_bot_stack.storage.base",
      "name": "storage.base",
      "type": "module",
      "category": "core",
      "path": "telegram_bot_stack/storage/base.py",
      "description": "Abstract base class defining storage backend interface",
      "lines_of_code": 63,
      "complexity_score": 1,
      "exports": [
        "StorageBackend"
      ],
      "imports": {
        "internal": [],
        "external": [
          "abc.ABC",
          "abc.abstractmethod",
          "typing.Any"
        ]
      },
      "dependencies": [],
      "dependents": [
        "telegram_bot_stack.storage",
        "telegram_bot_stack.storage.json",
        "telegram_bot_stack.storage.memory",
        "telegram_bot_stack.user_manager",
        "telegram_bot_stack.admin_manager",
        "telegram_bot_stack.bot_base"
      ],
      "classes": [
        {
          "name": "StorageBackend",
          "description": "Abstract base class for storage backends",
          "type": "abstract",
          "abstract_methods": [
            "save",
            "load",
            "exists",
            "delete"
          ],
          "interface_contract": "All storage backends must implement this interface"
        }
      ],
      "tags": [
        "core",
        "abstract",
        "interface",
        "contract",
        "foundation"
      ],
      "role": "Defines storage contract ensuring compatibility across implementations",
      "criticality": "critical",
      "design_pattern": "Strategy Pattern (Interface)"
    },
    {
      "id": "telegram_bot_stack.storage.json",
      "name": "storage.json",
      "type": "module",
      "category": "implementation",
      "path": "telegram_bot_stack/storage/json.py",
      "description": "JSON file-based storage backend implementation",
      "lines_of_code": 125,
      "complexity_score": 4,
      "exports": [
        "JSONStorage"
      ],
      "imports": {
        "internal": [
          "storage.base.StorageBackend"
        ],
        "external": [
          "json",
          "logging",
          "pathlib.Path",
          "typing.Any",
          "typing.Union"
        ]
      },
      "dependencies": [
        "telegram_bot_stack.storage.base"
      ],
      "dependents": [
        "telegram_bot_stack.storage",
        "telegram_bot_stack.__init__"
      ],
      "classes": [
        {
          "name": "JSONStorage",
          "description": "JSON file-based storage backend",
          "implements": "StorageBackend",
          "public_methods": [
            "save",
            "load",
            "exists",
            "delete"
          ],
          "features": [
            "File-based persistence",
            "UTF-8 encoding",
            "Auto-creates directories",
            "Pretty-printed JSON"
          ]
        }
      ],
      "tags": [
        "implementation",
        "storage-backend",
        "file-based",
        "persistent",
        "production-ready"
      ],
      "role": "Default production storage backend using JSON files",
      "criticality": "high",
      "design_pattern": "Strategy Pattern (Concrete Strategy)"
    },
    {
      "id": "telegram_bot_stack.storage.memory",
      "name": "storage.memory",
      "type": "module",
      "category": "implementation",
      "path": "telegram_bot_stack/storage/memory.py",
      "description": "In-memory storage backend for testing",
      "lines_of_code": 111,
      "complexity_score": 3,
      "exports": [
        "MemoryStorage"
      ],
      "imports": {
        "internal": [
          "storage.base.StorageBackend"
        ],
        "external": [
          "logging",
          "copy.deepcopy",
          "typing.Any"
        ]
      },
      "dependencies": [
        "telegram_bot_stack.storage.base"
      ],
      "dependents": [
        "telegram_bot_stack.storage",
        "telegram_bot_stack.__init__"
      ],
      "classes": [
        {
          "name": "MemoryStorage",
          "description": "In-memory storage backend for testing",
          "implements": "StorageBackend",
          "public_methods": [
            "save",
            "load",
            "exists",
            "delete",
            "clear"
          ],
          "features": [
            "In-memory dictionary storage",
            "Deep copy for data isolation",
            "No file I/O overhead",
            "Clear method for testing"
          ]
        }
      ],
      "tags": [
        "implementation",
        "storage-backend",
        "in-memory",
        "testing",
        "development"
      ],
      "role": "Testing and development storage backend with no persistence",
      "criticality": "medium",
      "design_pattern": "Strategy Pattern (Concrete Strategy)",
      "use_cases": [
        "Unit testing",
        "Integration testing",
        "Development",
        "Temporary data"
      ]
    },
    {
      "id": "telegram_bot_stack.storage.sql",
      "name": "storage.sql",
      "type": "module",
      "category": "implementation",
      "path": "telegram_bot_stack/storage/sql.py",
      "description": "SQL database storage backend using SQLAlchemy (SQLite/PostgreSQL)",
      "lines_of_code": 240,
      "complexity_score": 6,
      "exports": [
        "SQLStorage",
        "StorageRecord"
      ],
      "imports": {
        "internal": [
          "storage.base.StorageBackend"
        ],
        "external": [
          "json",
          "logging",
          "datetime.datetime",
          "typing.Any",
          "typing.Optional",
          "typing.Union",
          "sqlalchemy",
          "sqlalchemy.orm"
        ]
      },
      "dependencies": [
        "telegram_bot_stack.storage.base"
      ],
      "dependents": [
        "telegram_bot_stack.storage",
        "telegram_bot_stack.__init__"
      ],
      "classes": [
        {
          "name": "StorageRecord",
          "description": "SQLAlchemy model for storage records",
          "type": "orm_model",
          "fields": [
            "key (primary key)",
            "data (JSON text)",
            "created_at (timestamp)",
            "updated_at (timestamp)"
          ]
        },
        {
          "name": "SQLStorage",
          "description": "SQL database storage backend",
          "implements": "StorageBackend",
          "public_methods": [
            "save",
            "load",
            "exists",
            "delete",
            "close"
          ],
          "features": [
            "SQLite and PostgreSQL support",
            "Automatic table creation",
            "Connection pooling (PostgreSQL)",
            "Transaction support",
            "JSON serialization",
            "Timestamps tracking"
          ]
        }
      ],
      "tags": [
        "implementation",
        "storage-backend",
        "database",
        "production",
        "scalable",
        "optional-dependency"
      ],
      "role": "Production-grade SQL storage backend for scalable deployments",
      "criticality": "high",
      "design_pattern": "Strategy Pattern (Concrete Strategy)",
      "use_cases": [
        "Production deployments",
        "Large bots (>10k users)",
        "High concurrency",
        "Data integrity requirements",
        "Distributed systems (PostgreSQL)"
      ],
      "optional_dependencies": [
        "sqlalchemy>=2.0,<3.0",
        "alembic>=1.13,<2.0",
        "psycopg2-binary>=2.9 (for PostgreSQL)"
      ]
    },
    {
      "id": "telegram_bot_stack.decorators",
      "name": "decorators",
      "type": "module",
      "category": "core",
      "path": "telegram_bot_stack/decorators.py",
      "description": "Rate limiting and utility decorators for bot command handlers",
      "lines_of_code": 186,
      "complexity_score": 5,
      "exports": [
        "rate_limit"
      ],
      "imports": {
        "internal": [],
        "external": [
          "logging",
          "time",
          "functools.wraps",
          "typing.Callable",
          "typing.Literal",
          "typing.Optional",
          "telegram.Update",
          "telegram.ext.ContextTypes"
        ]
      },
      "dependencies": [],
      "dependents": [
        "telegram_bot_stack.__init__"
      ],
      "functions": [
        {
          "name": "rate_limit",
          "description": "Decorator for rate limiting command handlers",
          "parameters": [
            "calls: int",
            "period: int",
            "scope: Literal['user', 'global'] = 'user'",
            "message: Optional[str] = None"
          ],
          "returns": "Callable",
          "features": [
            "Per-user rate limiting",
            "Global rate limiting",
            "Admin bypass",
            "Storage integration",
            "Automatic cleanup",
            "Fail-open behavior",
            "Custom error messages"
          ]
        }
      ],
      "tags": [
        "core",
        "decorator",
        "rate-limiting",
        "spam-protection"
      ],
      "role": "Provides rate limiting for bot commands to prevent spam and abuse",
      "criticality": "medium"
    }
  ],
  "edges": [
    {
      "id": "edge_1",
      "source": "telegram_bot_stack.__init__",
      "target": "telegram_bot_stack.bot_base",
      "type": "imports",
      "strength": 1,
      "description": "Imports BotBase for public API",
      "relationship": "aggregation",
      "bidirectional": false
    },
    {
      "id": "edge_2",
      "source": "telegram_bot_stack.__init__",
      "target": "telegram_bot_stack.user_manager",
      "type": "imports",
      "strength": 1,
      "description": "Imports UserManager for public API",
      "relationship": "aggregation",
      "bidirectional": false
    },
    {
      "id": "edge_3",
      "source": "telegram_bot_stack.__init__",
      "target": "telegram_bot_stack.admin_manager",
      "type": "imports",
      "strength": 1,
      "description": "Imports AdminManager for public API",
      "relationship": "aggregation",
      "bidirectional": false
    },
    {
      "id": "edge_4",
      "source": "telegram_bot_stack.__init__",
      "target": "telegram_bot_stack.storage",
      "type": "imports",
      "strength": 5,
      "description": "Imports all storage components for public API",
      "relationship": "aggregation",
      "bidirectional": false
    },
    {
      "id": "edge_5",
      "source": "telegram_bot_stack.bot_base",
      "target": "telegram_bot_stack.admin_manager",
      "type": "uses",
      "strength": 3,
      "description": "Uses AdminManager for admin privilege management",
      "relationship": "composition",
      "bidirectional": false
    },
    {
      "id": "edge_6",
      "source": "telegram_bot_stack.bot_base",
      "target": "telegram_bot_stack.user_manager",
      "type": "uses",
      "strength": 3,
      "description": "Uses UserManager for user registration and tracking",
      "relationship": "composition",
      "bidirectional": false
    },
    {
      "id": "edge_7",
      "source": "telegram_bot_stack.bot_base",
      "target": "telegram_bot_stack.storage.base",
      "type": "depends_on",
      "strength": 2,
      "description": "Depends on StorageBackend interface for initialization",
      "relationship": "dependency_injection",
      "bidirectional": false
    },
    {
      "id": "edge_8",
      "source": "telegram_bot_stack.user_manager",
      "target": "telegram_bot_stack.storage.base",
      "type": "depends_on",
      "strength": 4,
      "description": "Depends on StorageBackend for persistence",
      "relationship": "dependency_injection",
      "bidirectional": false
    },
    {
      "id": "edge_9",
      "source": "telegram_bot_stack.admin_manager",
      "target": "telegram_bot_stack.storage.base",
      "type": "depends_on",
      "strength": 4,
      "description": "Depends on StorageBackend for persistence",
      "relationship": "dependency_injection",
      "bidirectional": false
    },
    {
      "id": "edge_10",
      "source": "telegram_bot_stack.storage",
      "target": "telegram_bot_stack.storage.base",
      "type": "imports",
      "strength": 1,
      "description": "Imports StorageBackend abstract class",
      "relationship": "aggregation",
      "bidirectional": false
    },
    {
      "id": "edge_11",
      "source": "telegram_bot_stack.storage",
      "target": "telegram_bot_stack.storage.json",
      "type": "imports",
      "strength": 2,
      "description": "Imports JSONStorage implementation",
      "relationship": "aggregation",
      "bidirectional": false
    },
    {
      "id": "edge_12",
      "source": "telegram_bot_stack.storage",
      "target": "telegram_bot_stack.storage.memory",
      "type": "imports",
      "strength": 2,
      "description": "Imports MemoryStorage implementation",
      "relationship": "aggregation",
      "bidirectional": false
    },
    {
      "id": "edge_13",
      "source": "telegram_bot_stack.storage.json",
      "target": "telegram_bot_stack.storage.base",
      "type": "implements",
      "strength": 5,
      "description": "Implements StorageBackend interface",
      "relationship": "inheritance",
      "bidirectional": false
    },
    {
      "id": "edge_14",
      "source": "telegram_bot_stack.storage.memory",
      "target": "telegram_bot_stack.storage.base",
      "type": "implements",
      "strength": 5,
      "description": "Implements StorageBackend interface",
      "relationship": "inheritance",
      "bidirectional": false
    },
    {
      "id": "edge_15",
      "source": "telegram_bot_stack.storage",
      "target": "telegram_bot_stack.storage.sql",
      "type": "imports",
      "strength": 2,
      "description": "Imports SQLStorage implementation (optional)",
      "relationship": "aggregation",
      "bidirectional": false
    },
    {
      "id": "edge_16",
      "source": "telegram_bot_stack.storage.sql",
      "target": "telegram_bot_stack.storage.base",
      "type": "implements",
      "strength": 5,
      "description": "Implements StorageBackend interface",
      "relationship": "inheritance",
      "bidirectional": false
    },
    {
      "id": "edge_17",
      "source": "telegram_bot_stack.__init__",
      "target": "telegram_bot_stack.decorators",
      "type": "imports",
      "strength": 3,
      "description": "Imports rate_limit decorator for public API",
      "relationship": "aggregation",
      "bidirectional": false
    }
  ],
  "layers": {
    "description": "Architectural layers of the framework",
    "layers": [
      {
        "name": "Public API Layer",
        "level": 0,
        "modules": [
          "telegram_bot_stack.__init__"
        ],
        "purpose": "Expose public API to end users",
        "visibility": "public"
      },
      {
        "name": "Core Business Logic Layer",
        "level": 1,
        "modules": [
          "telegram_bot_stack.bot_base",
          "telegram_bot_stack.user_manager",
          "telegram_bot_stack.admin_manager"
        ],
        "purpose": "Core bot functionality and management",
        "visibility": "public"
      },
      {
        "name": "Storage Abstraction Layer",
        "level": 2,
        "modules": [
          "telegram_bot_stack.storage"
        ],
        "purpose": "Unified storage interface and factory",
        "visibility": "public"
      },
      {
        "name": "Storage Contract Layer",
        "level": 3,
        "modules": [
          "telegram_bot_stack.storage.base"
        ],
        "purpose": "Define storage interface contract",
        "visibility": "public"
      },
      {
        "name": "Storage Implementation Layer",
        "level": 4,
        "modules": [
          "telegram_bot_stack.storage.json",
          "telegram_bot_stack.storage.memory",
          "telegram_bot_stack.storage.sql"
        ],
        "purpose": "Concrete storage backend implementations",
        "visibility": "internal"
      }
    ]
  },
  "design_patterns": {
    "patterns_used": [
      {
        "name": "Strategy Pattern",
        "description": "Storage backends implement common interface (StorageBackend)",
        "participants": [
          "telegram_bot_stack.storage.base",
          "telegram_bot_stack.storage.json",
          "telegram_bot_stack.storage.memory",
          "telegram_bot_stack.storage.sql"
        ],
        "benefit": "Easy to add new storage backends without changing core logic"
      },
      {
        "name": "Dependency Injection",
        "description": "Storage backend is injected into managers and bot",
        "participants": [
          "telegram_bot_stack.bot_base",
          "telegram_bot_stack.user_manager",
          "telegram_bot_stack.admin_manager"
        ],
        "benefit": "Loose coupling, testability, flexibility"
      },
      {
        "name": "Template Method",
        "description": "BotBase provides hooks for customization",
        "participants": [
          "telegram_bot_stack.bot_base"
        ],
        "hooks": [
          "on_user_registered",
          "get_user_status",
          "get_welcome_message",
          "register_handlers"
        ],
        "benefit": "Extensibility without modifying core bot logic"
      },
      {
        "name": "Factory Method",
        "description": "create_storage factory for creating storage backends",
        "participants": [
          "telegram_bot_stack.storage"
        ],
        "benefit": "Centralized object creation with type safety"
      },
      {
        "name": "Composition over Inheritance",
        "description": "BotBase composes UserManager and AdminManager",
        "participants": [
          "telegram_bot_stack.bot_base",
          "telegram_bot_stack.user_manager",
          "telegram_bot_stack.admin_manager"
        ],
        "benefit": "Flexibility, reusability, single responsibility"
      }
    ]
  },
  "usage_scenarios": {
    "scenarios": [
      {
        "name": "Create Simple Bot",
        "flow": [
          "Import from telegram_bot_stack.__init__",
          "Create storage instance (JSONStorage or MemoryStorage)",
          "Create BotBase instance with storage",
          "Optionally override hooks",
          "Run bot"
        ],
        "modules_involved": [
          "telegram_bot_stack.__init__",
          "telegram_bot_stack.bot_base",
          "telegram_bot_stack.storage.json"
        ]
      },
      {
        "name": "Add New Storage Backend",
        "flow": [
          "Create new class inheriting from StorageBackend",
          "Implement abstract methods (save, load, exists, delete)",
          "Add to storage.__init__.py imports",
          "Add to create_storage factory function",
          "Update tests"
        ],
        "modules_to_modify": [
          "telegram_bot_stack.storage",
          "tests"
        ],
        "modules_unchanged": [
          "telegram_bot_stack.bot_base",
          "telegram_bot_stack.user_manager",
          "telegram_bot_stack.admin_manager"
        ]
      },
      {
        "name": "Customize Bot Behavior",
        "flow": [
          "Create subclass of BotBase",
          "Override hooks (on_user_registered, get_welcome_message, etc.)",
          "Add custom command handlers in register_handlers",
          "Initialize with storage backend"
        ],
        "modules_involved": [
          "telegram_bot_stack.bot_base",
          "telegram_bot_stack.user_manager",
          "telegram_bot_stack.admin_manager"
        ]
      }
    ]
  },
  "extension_points": {
    "how_to_extend": [
      {
        "extension_type": "Add Storage Backend",
        "difficulty": "Easy",
        "steps": [
          "Inherit from StorageBackend",
          "Implement abstract methods",
          "Add to storage factory"
        ],
        "affected_modules": [
          "telegram_bot_stack.storage"
        ],
        "unchanged_modules": [
          "telegram_bot_stack.bot_base",
          "telegram_bot_stack.user_manager",
          "telegram_bot_stack.admin_manager"
        ]
      },
      {
        "extension_type": "Customize Bot",
        "difficulty": "Easy",
        "steps": [
          "Subclass BotBase",
          "Override hooks",
          "Add custom handlers"
        ],
        "affected_modules": [
          "User's custom bot module"
        ],
        "unchanged_modules": [
          "All framework modules"
        ]
      },
      {
        "extension_type": "Add Manager",
        "difficulty": "Medium",
        "steps": [
          "Create new manager class",
          "Accept StorageBackend in __init__",
          "Add to BotBase composition",
          "Update __init__.py exports"
        ],
        "affected_modules": [
          "telegram_bot_stack.bot_base",
          "telegram_bot_stack.__init__"
        ],
        "unchanged_modules": [
          "telegram_bot_stack.storage",
          "telegram_bot_stack.user_manager",
          "telegram_bot_stack.admin_manager"
        ]
      }
    ]
  },
  "ai_agent_hints": {
    "navigation_tips": [
      "Start from telegram_bot_stack.__init__ to see all public API",
      "BotBase is the main entry point for bot functionality",
      "StorageBackend is the contract - all storage implementations must follow it",
      "UserManager and AdminManager are independent components composed in BotBase",
      "To add features: check if you can use hooks in BotBase first",
      "To add storage: implement StorageBackend interface",
      "Check 'dependents' field to see impact of changes"
    ],
    "common_tasks": [
      {
        "task": "Find where users are registered",
        "location": "telegram_bot_stack.user_manager.UserManager.add_user"
      },
      {
        "task": "Find where admin privileges are checked",
        "location": "telegram_bot_stack.admin_manager.AdminManager.is_admin"
      },
      {
        "task": "Find bot command handlers",
        "location": "telegram_bot_stack.bot_base.BotBase methods (start, my_id, list_users, etc.)"
      },
      {
        "task": "Find storage interface",
        "location": "telegram_bot_stack.storage.base.StorageBackend"
      },
      {
        "task": "Find customization points",
        "location": "telegram_bot_stack.bot_base.BotBase hooks (on_user_registered, get_welcome_message, etc.)"
      },
      {
        "task": "Add new storage backend",
        "steps": [
          "Create class in telegram_bot_stack/storage/ inheriting StorageBackend",
          "Implement save, load, exists, delete",
          "Add to storage/__init__.py",
          "Add to create_storage factory"
        ]
      }
    ],
    "code_reading_order": [
      "1. telegram_bot_stack.__init__ - See public API",
      "2. telegram_bot_stack.storage.base - Understand storage contract",
      "3. telegram_bot_stack.storage.json - See default implementation",
      "4. telegram_bot_stack.user_manager - Simple manager example",
      "5. telegram_bot_stack.admin_manager - Manager with business logic",
      "6. telegram_bot_stack.bot_base - Main bot implementation"
    ],
    "testing_strategy": [
      "Use MemoryStorage for unit tests (no file I/O)",
      "Test managers independently with mock storage",
      "Test BotBase with both storage backends",
      "Check storage contract compliance for new backends"
    ]
  },
  "quality_metrics": {
    "maintainability_score": 8.5,
    "extensibility_score": 9.0,
    "testability_score": 8.8,
    "documentation_score": 8.0,
    "dependency_health": {
      "circular_dependencies": 0,
      "max_depth": 4,
      "coupling": "loose",
      "cohesion": "high"
    },
    "notes": [
      "Clean separation of concerns",
      "Well-defined interfaces",
      "Easy to test with dependency injection",
      "Good use of design patterns"
    ]
  }
}
